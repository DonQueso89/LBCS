import*as t from"../utils/index.min.js";import e from"./InteractableMethods.min.js";function n(t,e,n,r,a){return e.testIgnoreAllow(e.options[t.name],n,r)&&e.options[t.name].enabled&&i(e,n,t,a)?t:null}function r(t,e,r,a,o,i,c){for(let s=0,l=a.length;s<l;s++){const l=a[s],u=o[s],m=l.getAction(e,r,t,u);if(!m)continue;const p=n(m,l,u,i,c);if(p)return{action:p,interactable:l,element:u}}return{action:null,interactable:null,element:null}}function a(e,n,a,o,i){let c=[],s=[],l=o;function u(t){c.push(t),s.push(l)}for(;t.is.element(l);){c=[],s=[],i.interactables.forEachMatch(l,u);const m=r(e,n,a,c,s,o,i);if(m.action&&!m.interactable.options[m.action.name].manualStart)return m;l=t.dom.parentNode(l)}return{action:null,interactable:null,element:null}}function o(e,{action:n,interactable:r,element:a},o){n=n||{name:null},e.interactable=r,e.element=a,t.copyAction(e.prepared,n),e.rect=r&&n.name?r.getRect(a):null,l(e,o),o.fire("autoStart:prepared",{interaction:e})}function i(t,e,n,r){const a=t.options,o=a[n.name].max,i=a[n.name].maxPerElement,c=r.autoStart.maxInteractions;let s=0,l=0,u=0;if(!(o&&i&&c))return!1;for(const a of r.interactions.list){const r=a.prepared.name;if(a.interacting()){if(s++,s>=c)return!1;if(a.interactable===t){if(l+=r===n.name?1:0,l>=o)return!1;if(a.element===e&&(u++,r===n.name&&u>=i))return!1}}}return c>0}function c(e,n){return t.is.number(e)?(n.autoStart.maxInteractions=e,this):n.autoStart.maxInteractions}function s(t,e,n){const{cursorElement:r}=n.autoStart;r&&r!==t&&(r.style.cursor=""),t.ownerDocument.documentElement.style.cursor=e,t.style.cursor=e,n.autoStart.cursorElement=e?t:null}function l(e,n){const{interactable:r,element:a,prepared:o}=e;if("mouse"!==e.pointerType||!r||!r.options.styleCursor)return void(n.autoStart.cursorElement&&s(n.autoStart.cursorElement,"",n));let i="";if(o.name){const c=r.options[o.name].cursorChecker;i=t.is.func(c)?c(o,r,a,e._interacting):n.actions.map[o.name].getCursor(o)}s(e.element,i||"",n)}const u={id:"auto-start/base",before:["actions","actions/drag","actions/resize","actions/gesture"],install(n){const{interactStatic:r,defaults:a}=n;n.usePlugin(e),a.base.actionChecker=null,a.base.styleCursor=!0,t.extend(a.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),r.maxInteractions=t=>c(t,n),n.autoStart={maxInteractions:1/0,withinInteractionLimit:i,cursorElement:null}},listeners:{"interactions:down"({interaction:t,pointer:e,event:n,eventTarget:r},i){t.interacting()||o(t,a(t,e,n,r,i),i)},"interactions:move"(t,e){!function({interaction:t,pointer:e,event:n,eventTarget:r},i){if("mouse"!==t.pointerType||t.pointerIsDown||t.interacting())return;o(t,a(t,e,n,r,i),i)}(t,e),function(t,e){const{interaction:n}=t;if(!n.pointerIsDown||n.interacting()||!n.pointerWasMoved||!n.prepared.name)return;e.fire("autoStart:before-start",t);const{interactable:r}=n,a=n.prepared.name;a&&r&&(r.options[a].manualStart||!i(r,n.element,n.prepared,e)?n.stop():(n.start(n.prepared,r,n.element),l(n,e)))}(t,e)},"interactions:stop"({interaction:t},e){const{interactable:n}=t;n&&n.options.styleCursor&&s(t.element,"",e)}},maxInteractions:c,withinInteractionLimit:i,validateAction:n};export default u;
//# sourceMappingURL=base.min.js.map